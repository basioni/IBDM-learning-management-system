/*! BuddyDrive - v2.1.0 - 2017-04-11 11:17:17 PM UTC - https://github.com/mrpritchett/buddydrive/ */
window.bp=window.bp||{},function(a,b){"undefined"!=typeof BP_Uploader&&(bp.Models=bp.Models||{},bp.Collections=bp.Collections||{},bp.Views=bp.Views||{},bp.BuddyDrive={start:function(){this.views=new Backbone.Collection,this.warning=null,this.uploaderView(),this.buddyfiles=bp.Uploader.filesUploaded},uploaderView:function(){bp.Uploader.filesQueue.on("add",this.uploadProgress,this);var a=new bp.Views.Uploader;this.views.add({id:"upload",view:a}),a.inject(".buddydrive-uploader")},uploadProgress:function(){var a=new bp.Views.uploadBuddyfileStatus({collection:bp.Uploader.filesQueue});_.isUndefined(this.views.get("status"))?this.views.add({id:"status",view:a}):this.views.set({id:"status",view:a}),a.inject(".buddydrive-uploader-status")}},bp.Views.uploadBuddyfileStatus=bp.Views.uploaderStatus.extend({className:"files",events:{"click .bd-insert":"sendtoEditor"},initialize:function(){bp.Views.uploaderStatus.prototype.initialize.apply(this,arguments),this.collection.on("change:url",this.updateEntry,this)},updateEntry:function(a){var c=BP_Uploader.strings.buddydrive_insert;_.isUndefined(a.get("icon"))||b("#"+a.get("id")+" .filename img").length||(b("#"+a.get("id")+" .filename").prepend('<img src="'+a.get("icon")+'"> '),b("#"+a.get("id")+" .bp-progress").addClass("bd-success"),b("#"+a.get("id")+" .bp-progress").html('<a href="#" class="bd-insert button" data-fileurl="'+a.get("url")+'">'+c+"</a>"))},sendtoEditor:function(a){var c,d=null,e="undefined"!=typeof tinymce,f="undefined"!=typeof QTags;if(a.preventDefault(),d=b(a.target).data("fileurl"),_.isUndefined(BP_Uploader.strings.buddydrive_editor_id)){if(_.isUndefined(window.wpActiveEditor)){if(e&&tinymce.activeEditor)c=tinymce.activeEditor,window.wpActiveEditor=c.id;else if(!f)return!1}else e&&(c=tinymce.get(window.wpActiveEditor));c&&!c.isHidden()?c.execCommand("mceInsertContent",!1,d):f?QTags.insertContent(d):window.wpActiveEditor&&(b(window.wpActiveEditor).value+=d)}else c=BP_Uploader.strings.buddydrive_editor_id,0===b("#"+c).val().length?b("#"+c).val(d+"\n").focus():b("#"+c).val(b("#"+c).val()+"\n"+d).focus();if(window.tb_remove)try{window.tb_remove()}catch(g){}}}),bp.BuddyDrive.start())}(bp,jQuery);